/*
 * jQuery dateDropDowns
 *
 * url		http://www.amdonnelly.co.uk/things/date-drop-down-lists.aspx
 * author	Alan Donnelly 2011
 * version	1.0.1
 * license	MIT and GPL licenses
 */
(function(a){a.fn.dateDropDowns=function(b){var c={dateFormat:"dd-mm-yy",monthNames:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],yearStart:"1979",yearEnd:"2011"};var b=a.extend(c,b);return this.each(function(){var l=a(this);var i=l.html();var s=l.attr("id")+"_dateLists";var f=s+"_day";var k=s+"_month";var t=s+"_year";var o=l.val();var j=new Date();var n=(c.dateFormat.indexOf("/")>-1)?"/":"-";d();u();m();h();function d(){if(o.length>0){var v=c.dateFormat.split(n);var w=o.split(n);var x=new Date();for(_x=0;_x<w.length;_x++){if(v[_x].toLowerCase().indexOf("d")>-1){x.setDate(w[_x])}else{if(v[_x].toLowerCase().indexOf("m")>-1){x.setMonth(w[_x]-1)}else{if(v[_x].toLowerCase().indexOf("y")>-1){x.setYear(w[_x])}}}}j=x}}function u(){var v=c.dateFormat.split(n);var w=l;l.replaceWith("<div id='"+s+"' class='dateLists_container'></div>");for(_x=0;_x<v.length;_x++){if(v[_x].toLowerCase().indexOf("d")>-1){a("#"+s).append("<div id='"+f+"' class='day_container'>");a("#"+f).append("<select id='"+f+"_list' name='"+f+"_list' class='list'></select>");a("#"+s).append("</div>")}else{if(v[_x].toLowerCase().indexOf("m")>-1){a("#"+s).append("<div id='"+k+"' class='month_container'>");a("#"+k).append("<select id='"+k+"_list' name='"+k+"_list' class='list'></select>");a("#"+s).append("</div>")}else{if(v[_x].toLowerCase().indexOf("y")>-1){a("#"+s).append("<div id='"+t+"' class='year_container'>");a("#"+t).append("<select id='"+t+"_list' name='"+t+"_list' class='list'></select>");a("#"+s).append("</div>")}}}}a("#"+s).append(w);l.hide()}function m(){r();e();g()}function r(){var y=j.getMonth()+1;var v="";var w=1;_daysInMonth=p(y,j.getFullYear())+1;if(a("#"+f+"_list").children().length<_daysInMonth){w=a("#"+f+"_list").children().length+1}else{a("#"+f+"_list").children().remove()}for(_x=w;_x<_daysInMonth;_x++){var x=(j.getDate()==_x)?"selected='true'":"";v+="<option value='"+_x+"' "+x+">"+_x+"</option>"}a("#"+f+"_list").append(v)}function p(v,w){var x=31;if(v==4||v==6||v==9||v==11){x=30}else{if(v==2){if((w%4)==0){x=29}else{x=28}}}return x}function e(){a("#"+k+"_list").children().remove();for(_x=0;_x<12;_x++){var v=((j.getMonth())==_x)?"selected='true'":"";a("#"+k+"_list").append("<option value='"+_x+"' "+v+">"+c.monthNames[_x]+"</option>")}}function g(){a("#"+t+"_list").children().remove();var v=parseInt(c.yearStart);var x=parseInt(c.yearEnd);if(x>v){for(_x=v;_x<x+1;_x++){var w=((j.getFullYear())==_x)?"selected='true'":"";a("#"+t+"_list").append("<option value='"+_x+"' "+w+">"+_x+"</option>")}}else{for(_y=v;_y>2005;_y--){var w=((j.getFullYear())==_y)?"selected='true'":"";a("#"+t+"_list").append("<option value='"+_y+"' "+w+">"+_y+"</option>")}}}function h(){a("#"+f+"_list").change(function(){j.setDate(a("#"+f+"_list").val());q()});a("#"+k+"_list").change(function(){var x=parseInt(a("#"+k+"_list").val());var v=j.getDate();_daysInMonth=p(x+1,j.getFullYear());if(v>_daysInMonth){v=_daysInMonth}var w=new Date(j.getFullYear(),x,v,0,0,0,0);j=w;r();q()});a("#"+t+"_list").change(function(){var v=a("#"+t+"_list").val();var x=j.getDate();var w=j.getMonth();_daysInMonth=p(w+1,v);if(x>_daysInMonth){x=_daysInMonth}var y=new Date(v,w,x,0,0,0,0);j=y;r();q()})}function q(){var y=j.getDate();var w=j.getMonth()+1;var v=j.getFullYear();var x=c.dateFormat;if(x.indexOf("DD")>-1&&y.toString().length<2){y="0"+y}if(x.indexOf("MM")>-1&&w.toString().length<2){w="0"+w}var z=c.dateFormat.toLowerCase();z=z.replace("dd",y);z=z.replace("mm",w);z=z.replace("yy",v);l.val(z)}})}})(jQuery);